<!DOCTYPE regexes SYSTEM "regexes.dtd">
<regexes>
<!-- These define the basic grammar of chemical words. These build the single-letter
codes found in regexTokens and the other tokenlist files into a large regular
expression, which is used in parsing.

Note that this is NOT a CFG! This file is read entry by entry, building up
a dictionary of the translated form of each term as it goes. This has
the consquence that if you want to use a term, you must define it in a previous
<regex> first. Note that this disallows recursive definitions, and hence this
does not define a CFG.
 -->

<!-- base level regexes, a mirror of the token files -->
  <regex name="%alkaneStem%" value="a"/>
  <regex name="%cyclicUnsaturableHydrocarbon%" value="A"/>
  <regex name="%alkaneStemModifier%" value="n"/>
  <regex name="%suffix%" value="s"/>
  <regex name="%unsaturator%" value="u"/>
  <regex name="%inlineSuffix%" value="i"/>
  <regex name="%simpleSubstituent%" value="x"/>
  <regex name="%simpleMultiplier%" value="m"/>
  <regex name="%elidedAMultiplier%" value="r"/>
  <regex name="%groupMultiplier%" value="R"/>
  <regex name="%groupStemAllowingInlineSuffixes%" value="g"/>
  <regex name="%simpleGroup%" value="G"/>
  <regex name="%locantGroup%" value="l"/>
  <regex name="%hyphen%" value="h"/>
  <regex name="%openBracket%" value="o"/>
  <regex name="%closeBracket%" value="c"/>
  <regex name="%acidStem%" value="d"/>
  <regex name="%trivialRingSubstituent%" value="b"/>
  <regex name="%cyclo%" value="C"/>
  <regex name="%vonBaeyer%" value="B"/>
  <regex name="%spiroDescriptor%" value="S"/>
  <regex name="%heteroAtom%" value="H"/>
  <regex name="%heteroAtomaElided%" value="v"/>
  <regex name="%hantzschWidmanSuffix%" value="W"/>
  <regex name="%trivialRing%" value="z"/>
  <regex name="%fusionRing%" value="f"/>
  <regex name="%fusionBracket%" value="F"/>
  <regex name="%hydro%" value="y"/>
  <regex name="%bigCapitalH%" value="e"/>
  <regex name="%annulen%" value="N"/>
  <regex name="%orthoMetaPara%" value="O"/>
  <regex name="%stereochemistryBracket%" value="E"/>
  <regex name="%cisOrTrans%" value="t"/>
  <regex name="%heteroStem%" value="p"/>
  <regex name="%o%" value="Y"/>
  <regex name="%e%" value="Z"/>
  <regex name="%inlineChargeSuffix%" value="I"/>
  <regex name="%suffixableSubstituent%" value="X"/>
  <regex name="%hwHeteroAtom%" value="D"/>
  <regex name="%optionalOpenBracket%" value="T"/>
  <regex name="%optionalCloseBracket%" value="U"/>
  <regex name="%hwAneCompatible%" value="j"/>
  <regex name="%hwIneCompatible%" value="J"/>
  <regex name="%hwAne%" value="k"/>
  <regex name="%hwIne%" value="K"/>
  <regex name="%ringAssemblyMultiplier%" value="P"/>
  <regex name="%ringAssemblyLocant%" value="L"/>
  <regex name="%vonBaeyerMultiplier%" value="M"/>
  <regex name="%structuralOpenBracket%" value="q"/>
  <regex name="%structuralCloseBracket%" value="Q"/>
  <regex name="%repeatableInlineSuffix%" value="w"/>
  <regex name="%FR2hydrocarbonComponent%" value="V"/>
  <regex name="%lambdaConvention%" value="Ç"/>
  <regex name="%replacementInfix%" value="ü"/>
  <regex name="%endOfSubstituent%" value="é"/>
  <regex name="%endOfMainGroup%" value="â"/>
  <regex name="%interSubstituentHyphen%" value="ä"/>
  <regex name="%ane%" value="à"/>
  <regex name="%suffixesThatCanBeModifiedByAPrefix%" value="å"/>
  <regex name="%comma%" value="ç"/>
  <regex name="%groupStemAllowingAllSuffixes%" value="ê"/>
  <regex name="%aminoAcidEndsInIne%" value="ë"/>
  <regex name="%aminoAcidEndsInAn%" value="è"/>
  <regex name="%aminoAcidEndsInIc%" value="ï"/>
  <regex name="%ine%" value="î"/>
  <regex name="%suffixPrefix%" value="ì"/>
  <regex name="%multipleFusor%" value="Ä"/>
  <regex name="%benzo%" value="Å"/>
  <regex name="%locantThatNeedsBrackets%" value="É"/>
  <regex name="%basicFunctionalClass%" value="æ"/>
  <regex name="%multiplyableFunctionalClass%" value="Æ"/>
  <regex name="%monovalentFunctionalGroup%" value="ô"/>
  <regex name="%divalentFunctionalGroup%" value="ö"/>
  <regex name="%standaloneMonovalentFunctionalGroup%" value="ò"/>
  <regex name="%endOfFunctionalGroup%" value="û"/>
  <regex name="%functionalModifier%" value="ù"/>
  <regex name="%infixableInlineSuffix%" value="ÿ"/>
  <regex name="%monoNuclearNonCarbonAcid%" value="Ö"/>
  <regex name="%anhydride%" value="Ü"/>
  <regex name="%anhydrideLocant%" value="¢"/>
  <regex name="%implicitIc%" value="£"/>
  <regex name="%aminoAcidYl%" value="¥"/>
  <regex name="%oMeaningYl%" value="₧"/>
  <regex name="%monoNuclearNonCarbonAcidNoAcyl%" value="ƒ"/>
  <regex name="%simpleCyclicGroup%" value="á"/>
  <regex name="%acetalClass%" value="í"/>
  <regex name="%chalcogenReplacement%" value="ó"/>
  <regex name="%perhydro%" value="ú"/>
  <regex name="%chalcogenAcid%" value="ñ"/>
  <regex name="%ylamine%" value="Ñ"/>
  <regex name="%lightRotation%" value="ª"/>
  <regex name="%symPolycylicSpiro%" value="º"/>
  <regex name="%dispiroter%" value="¿"/>
  <regex name="%spiro%" value="⌐"/>
  <regex name="%spiroLocant%" value="½"/>
  <regex name="%relativeCisTrans%" value="¼"/>
  <!--up to ascii 172 used -->

<!-- composite regexes-->

<!-- UsefulTerms-->
  <regex name="%multiplier%" value="((%simpleMultiplier%|%elidedAMultiplier%|%groupMultiplier%)%hyphen%?)"/>
  <regex name="%simpleMultiplierGroup%" value="(%simpleMultiplier%%hyphen%?)"/>
  <regex name="%stereochemistry%" value="((%stereochemistryBracket%|(%locantGroup%?%cisOrTrans%)(%comma%%locantGroup%?%cisOrTrans%)*|%lightRotation%)%hyphen%?)"/>
  <regex name="%optLocantGroupNoOMP%" value="(%hyphen%?%locantGroup%?)"/>
  <regex name="%optLocantGroup%" value="(%hyphen%?(%locantGroup%|%orthoMetaPara%)?)"/>
  <regex name="%newLocantGroupNoStartingHyphen%" value="(%locantGroup%|%orthoMetaPara%)"/><!--Substituents/mainGroups may not start with a hyphen (otherwise it is ambiguous as to where to break up the name so this is used for prefixes-->
  <regex name="%bracketedLocant%" value="(%optionalOpenBracket%%locantThatNeedsBrackets%%optionalCloseBracket%%hyphen%?)"/>
  <regex name="%infixReplacement%" value ="(%multiplier%?%replacementInfix%(%o%?%multiplier%?%replacementInfix%)*%o%?)"/>
  <regex name="%infixedInlineSuffix%" value="(%o%?%infixReplacement%%infixableInlineSuffix%|%structuralOpenBracket%%infixReplacement%%infixableInlineSuffix%%structuralCloseBracket%)"/>
  <regex name="%infixedPrefixedInlineSuffix%" value ="(%suffixPrefix%%infixReplacement%%infixableInlineSuffix%)" />
  <regex name="%unlocantedInlineSuffixGroup%" value="(%simpleMultiplierGroup%?(%infixedInlineSuffix%|%inlineSuffix%|%infixedPrefixedInlineSuffix%|(%o%?%infixReplacement%)?%suffixPrefix%%infixableInlineSuffix%))"/>
  <regex name="%inlineSuffixGroup%" value="(%optLocantGroup%?%unlocantedInlineSuffixGroup%)"/>
  <regex name="%repeatableInlineSuffixGroup%" value="(%optLocantGroup%?%simpleMultiplierGroup%?%repeatableInlineSuffix%)"/>
  <regex name="%inlineChargeGroup%" value="(%optLocantGroup%?%multiplier%?%inlineChargeSuffix%)"/>
  <regex name="%inlineEndings%" value="(%inlineChargeGroup%*%inlineSuffixGroup%%repeatableInlineSuffixGroup%*)"/>
  <regex name="%unsaturation%" value="(%optLocantGroupNoOMP%?%multiplier%?%unsaturator%)"/>
  <regex name="%unsaturationBlock%" value="((%hyphen%?%ane%|%unsaturation%)%unsaturation%*)"/>
  <regex name="%heteroReplacement%" value="((%newLocantGroupNoStartingHyphen%?%multiplier%|(%locantGroup%?|%lambdaConvention%)%multiplier%?)%heteroAtom%%hyphen%?)"/>
  <regex name="%hydroGroup%" value="((%locantGroup%?%multiplier%%hydro%|%perhydro%)%hyphen%?)"/>
  <regex name="%suffixes%" value="(%suffixesThatCanBeModifiedByAPrefix%|%suffix%)"/>
  <regex name="%infixedSuffix%" value ="((%o%?%infixReplacement%%suffixes%)|(%structuralOpenBracket%%infixReplacement%%suffixes%%structuralCloseBracket%))" />
  <regex name="%infixedPrefixedSuffix%" value ="(%suffixPrefix%%infixReplacement%%suffixesThatCanBeModifiedByAPrefix%)" />
  <regex name="%rootSuffix%" value= "(%suffix%|%o%?%suffixesThatCanBeModifiedByAPrefix%)" />
  <regex name="%unlocantedSuffixGroup%" value="(%multiplier%?(%infixedSuffix%|%infixedPrefixedSuffix%|%rootSuffix%|(%o%?%infixReplacement%)?%suffixPrefix%%suffixesThatCanBeModifiedByAPrefix%)|%multiplier%%optionalOpenBracket%%rootSuffix%%optionalCloseBracket%)"/>
  <regex name="%suffixGroup%" value="((%relativeCisTrans%|%optLocantGroup%)?%unlocantedSuffixGroup%)"/>
  <regex name="%rootEnding%" value="(%inlineChargeGroup%*%suffixGroup%?)"/>
  <regex name="%locantOpenBracket%" value="(%stereochemistry%*%newLocantGroupNoStartingHyphen%{0,2}%multiplier%?%openBracket%%hyphen%?)"/>
  <regex name="%ring_CanStartWithHydro_NonDetachableFeatures%" value="((%heteroReplacement%|%hydroGroup%)*(%bigCapitalH%?%lambdaConvention%?|%lambdaConvention%?%bigCapitalH%?)%heteroReplacement%*)"/><!--bigCapitalH before lambdaConvention is preferred. Heteroatomreplacement should not really be after indicated hydrogen-->
  <regex name="%ringNonDetachableFeatures%" value="(%heteroReplacement%*(%bigCapitalH%?%lambdaConvention%?|%lambdaConvention%?%bigCapitalH%?)%heteroReplacement%*%newLocantGroupNoStartingHyphen%?)"/><!--last locant is an indirect locant for suffixes -->
  <regex name="%acyclicNonDetachableFeatures%" value="(%heteroReplacement%*%lambdaConvention%?%newLocantGroupNoStartingHyphen%?)"/><!--last locant is an indirect locant for suffixes-->


<!-- groups-->
  <!--acyclic-->
  <regex name="%heteroChain%" value = "((%multiplier%%heteroStem%%unsaturationBlock%)|(%heteroStem%%hyphen%?%ane%))"/>
  <regex name="%alternatingHeteroChain%" value = "(%multiplier%(%heteroAtom%|%heteroAtomaElided%){2,}%unsaturationBlock%)"/>

  <regex name="%straightChainGroups%" value = "(%heteroChain%|%alternatingHeteroChain%|%alkaneStem%%unsaturationBlock%)"/>
  <regex name="%chainGroup%" value = "(%heteroChain%|%alternatingHeteroChain%|%alkaneStemModifier%?%alkaneStem%%unsaturationBlock%)"/>
  <regex name="%chainSubstituent%" value = "((%chainGroup%|%alkaneStemModifier%?%alkaneStem%)%inlineEndings%)"/>

  <regex name="%aminoMonoAcid%" value="(%aminoAcidEndsInIne%%ine%|%aminoAcidEndsInAn%%ane%)"/>
  <regex name="%aminoAcidOptionalIne%" value="(%aminoAcidEndsInIne%%ine%?|%aminoAcidEndsInAn%%ane%?|%aminoAcidEndsInIc%)"/>
  <regex name="%aminoAcidGroup%" value="(%aminoMonoAcid%%implicitIc%%inlineChargeSuffix%?|(%aminoMonoAcid%|%aminoAcidEndsInIc%)(%infixedSuffix%|%rootSuffix%))"/>

  <regex name="%aminoAcidLocantedYl%" value ="((%aminoMonoAcid%%implicitIc%|%aminoAcidEndsInIc%%rootSuffix%)%hyphen%?%locantGroup%%aminoAcidYl%)"/>
  <regex name="%aminoAcidRadicalOnN%" value ="((%aminoMonoAcid%|%aminoAcidEndsInIc%)%implicitIc%%oMeaningYl%)"/>
  <regex name="%aminoAcidSubstituent%" value="(%aminoAcidLocantedYl%|%aminoAcidRadicalOnN%|%aminoAcidOptionalIne%(%infixedInlineSuffix%|%inlineSuffix%))"/>

  <regex name="%nonCarbonAcidGroup%" value="((%monoNuclearNonCarbonAcid%|%monoNuclearNonCarbonAcidNoAcyl%)(%infixedSuffix%|%rootSuffix%)|%chalcogenAcid%(%infixedSuffix%|%o%?%rootSuffix%))"/>
  <regex name="%nonCarbonAcidSubstituent%" value="(%monoNuclearNonCarbonAcid%(%infixedInlineSuffix%|%inlineSuffix%)|%chalcogenAcid%(%infixedInlineSuffix%|%inlineSuffix%|%o%%infixableInlineSuffix%))"/>

  <regex name="%acidGroup%" value = "(%acidStem%(%infixedSuffix%|%o%?%rootSuffix%)|%aminoAcidGroup%|%nonCarbonAcidGroup%)"/>
  <regex name="%acidSubstituent%" value = "(%acidStem%(%infixedInlineSuffix%|%inlineSuffix%|%o%%infixableInlineSuffix%)|%aminoAcidSubstituent%|%nonCarbonAcidSubstituent%)"/>

  <regex name="%simpleSubstituents%" value = "(%simpleSubstituent%|%suffixableSubstituent%%inlineSuffixGroup%%repeatableInlineSuffixGroup%*)"/>

  <!--cyclic-->
  <regex name="%semiTrivialFusedRing%" value = "(%vonBaeyerMultiplier%%FR2hydrocarbonComponent%)"/>
  <regex name="%vonBaeyerSystem%" value = "(%vonBaeyerMultiplier%%vonBaeyer%(%alkaneStem%%unsaturationBlock%|%heteroChain%))"/><!--support for alternating heteroChain missing-->
  <regex name="%cycloChain%" value = "(%cyclo%%straightChainGroups%)"/>
  <regex name="%cycloChainSubstituent%" value = "(%cyclo%%alkaneStem%)"/>
  <regex name="%spiroSystem%" value = "(%simpleMultiplierGroup%?%spiroDescriptor%%alkaneStem%%unsaturationBlock%)"/><!--support for heteroChain/alternating heteroChain missing-->
  <regex name="%hantzschWidmanRing%" value = "((%newLocantGroupNoStartingHyphen%|%bracketedLocant%)?((%multiplier%?%hwHeteroAtom%)*((%multiplier%?%hwAneCompatible%)%hwAne%)|((%multiplier%?%hwHeteroAtom%)*(%multiplier%?%hwIneCompatible%)%hwIne%)|((%multiplier%?%hwHeteroAtom%)+%hantzschWidmanSuffix%)))"/>
  <regex name="%fusionComponent%" value = "(%fusionRing%|%cycloChainSubstituent%|%annulen%%o%|%semiTrivialFusedRing%%o%|%hantzschWidmanRing%%o%)"/>
  <regex name="%cyclicUnsaturableHydrocarbonGroup%" value = "(%cyclicUnsaturableHydrocarbon%%unsaturationBlock%)" />
  <regex name="%trivialRingSubstituentGroup%" value = "(%bracketedLocant%?%trivialRingSubstituent%%unlocantedSuffixGroup%)" /><!-- possibly this term should be replaced by special cases-->
  <regex name="%trivialRingSubstituentSub%" value = "(%bracketedLocant%?%trivialRingSubstituent%%inlineSuffixGroup%)" />
<!-- allows abbreviated alkanes e.g. bicyclo[2.2.2]octyl instead of bicyclo[2.2.2]octanyl-->
  <regex name="%vonBaeyerSystemSubstituent%" value = "(%vonBaeyerMultiplier%%vonBaeyer%%alkaneStem%)"/>
  <regex name="%spiroSystemSubstituent%" value = "(%simpleMultiplierGroup%?%spiroDescriptor%%alkaneStem%)"/>

  <regex name="%conjunctiveSideChainRoot%" value ="(%optLocantGroupNoOMP%?%multiplier%?(%alkaneStem%%hyphen%?(%ane%%suffixGroup%|%ane%?%ylamine%)|%optionalOpenBracket%%alkaneStem%%hyphen%?%ane%?%ylamine%%optionalCloseBracket%|%acidStem%(%infixedSuffix%|%o%?%rootSuffix%)))"/>
  <regex name="%conjunctiveSideChainInline%" value ="(%optLocantGroupNoOMP%?%multiplier%?(%acidStem%(%infixedInlineSuffix%|%inlineSuffix%|%o%%infixableInlineSuffix%)))"/>

  <regex name="%ringGroup%" value = "((%semiTrivialFusedRing%|%hantzschWidmanRing%|%annulen%|(%locantGroup%|%bracketedLocant%)?%trivialRing%)%e%?|%vonBaeyerSystem%|%spiroSystem%|%trivialRingSubstituentGroup%|%cycloChain%|%cyclicUnsaturableHydrocarbonGroup%)"/>
  <regex name="%ringSubstituent%" value = "((%ringGroup%|%vonBaeyerSystemSubstituent%|%cycloChainSubstituent%|%spiroSystemSubstituent%|%cyclicUnsaturableHydrocarbon%)(%inlineEndings%|%conjunctiveSideChainInline%)|%trivialRingSubstituentSub%)"/>

  <!--Complex terms-->
  <regex name="%benzoComponent%" value ="((%bracketedLocant%|%locantGroup%)%benzo%)"/>
  <regex name="%simpleComponent%" value ="(%fusionComponent%%hyphen%?%fusionBracket%?%hyphen%?|%benzoComponent%)" />
  <regex name="%multipliedComponent%" value ="(%multiplier%(%fusionComponent%%hyphen%?%multipleFusor%?%hyphen%?|%benzoComponent%))" />
  <regex name="%multipliedParent%" value ="(%fusionComponent%%hyphen%?%multipleFusor%?%hyphen%?%multiplier%)"/>

  <regex name="%fusedRingSystem%" value = "((%simpleComponent%|%multipliedComponent%|%multipliedParent%)+(%ringGroup%|%simpleCyclicGroup%))"/>
  <regex name="%fusedRingSystemFromTrivialRingSubstituent%" value = "((%simpleComponent%|%multipliedComponent%|%multipliedParent%)+%trivialRingSubstituentSub%)"/>

	<regex name="%vonBaeyerForSpiro%" value="(%structuralOpenBracket%%vonBaeyerMultiplier%%vonBaeyer%(%alkaneStem%|%multiplier%%heteroStem%)%ane%%structuralCloseBracket%%unsaturation%+)" />
	<regex name="%polycyclicSpiroIdenticalComponents%" value ="((%symPolycylicSpiro%|%dispiroter%)((%ringGroup%|%fusedRingSystem%)|%structuralOpenBracket%%ring_CanStartWithHydro_NonDetachableFeatures%(%ringGroup%|%fusedRingSystem%)%structuralCloseBracket%|%vonBaeyerForSpiro%))"/>
  <regex name="%polycyclicSpiroContents%" value="(%ring_CanStartWithHydro_NonDetachableFeatures%(%ringGroup%|%fusedRingSystem%)(%hyphen%?%spiroLocant%%ring_CanStartWithHydro_NonDetachableFeatures%(%ringGroup%|%fusedRingSystem%))+)" />
  <regex name="%polycyclicSpiro%" value ="(%spiro%%structuralOpenBracket%%polycyclicSpiroContents%%structuralCloseBracket%)"/>
  <regex name="%polycyclicSpiroGroup%" value ="(%polycyclicSpiroIdenticalComponents%|%polycyclicSpiro%)" />

  <regex name="%ringAssemblyConjunctive%" value = "(%ring_CanStartWithHydro_NonDetachableFeatures%?(%ringGroup%|%simpleCyclicGroup%|%fusedRingSystem%)%rootEnding%)" />
  <regex name="%ringAssemblyAdditive%" value = "(%ring_CanStartWithHydro_NonDetachableFeatures%?(%ringSubstituent%|(%ringGroup%|%fusedRingSystem%)%inlineChargeGroup%*%inlineSuffixGroup%))" />
  <regex name="%ringAssemblyRing%" value = "(%ringAssemblyConjunctive%|%ringAssemblyAdditive%)" />
  <regex name="%locantForRingAssembly%" value = "(%ringAssemblyLocant%|%orthoMetaPara%|%optionalOpenBracket%%ringAssemblyLocant%%optionalCloseBracket%%hyphen%?)" />
  <regex name="%ringAssembly%" value = "(%locantForRingAssembly%?%ringAssemblyMultiplier%%hyphen%?(%ringAssemblyRing%|%structuralOpenBracket%%ringAssemblyRing%%structuralCloseBracket%))"/>

  <regex name="%allRingSubstituents%" value = "(%ringSubstituent%|((%ringAssembly%|%optionalOpenBracket%%ringAssembly%%optionalCloseBracket%)|%fusedRingSystem%|%polycyclicSpiroGroup%)(%inlineEndings%|%conjunctiveSideChainInline%)|%fusedRingSystemFromTrivialRingSubstituent%)"/>
  <regex name="%allOtherSubstituents%" value = "(%simpleSubstituents%|%chainSubstituent%|%acidSubstituent%|(%groupStemAllowingInlineSuffixes%|%groupStemAllowingAllSuffixes%)%e%?%inlineEndings%)"/>
  <regex name="%subsituentBody%" value= "(%ringNonDetachableFeatures%%allRingSubstituents%|%acyclicNonDetachableFeatures%%allOtherSubstituents%|%hydroGroup%)"/>
  <regex name="%substituent%" value= "(%locantOpenBracket%*%stereochemistry%*(%relativeCisTrans%|%newLocantGroupNoStartingHyphen%)?%multiplier%?%subsituentBody%%closeBracket%*%interSubstituentHyphen%?%endOfSubstituent%)"/>

  <regex name="%allRingGroups%" value = "((%ringGroup%|%ringAssembly%|%optionalOpenBracket%%ringAssembly%%optionalCloseBracket%|%fusedRingSystem%|%polycyclicSpiroGroup%)(%rootEnding%|%conjunctiveSideChainRoot%)|%simpleCyclicGroup%%conjunctiveSideChainRoot%?)"/>
  <regex name="%allOtherSuffixableGroups%" value = "((%groupStemAllowingAllSuffixes%%e%?|%chainGroup%)%rootEnding%|%acidGroup%|%groupStemAllowingInlineSuffixes%%e%?%inlineChargeGroup%*)"/>
  <regex name="%mainGroupBody%" value="(%ringNonDetachableFeatures%%allRingGroups%|%acyclicNonDetachableFeatures%(%allOtherSuffixableGroups%|%simpleGroup%))"/>
  <regex name="%mainGroup%" value="(%openBracket%?%multiplier%?%openBracket%?%stereochemistry%*%newLocantGroupNoStartingHyphen%?%mainGroupBody%%closeBracket%*%endOfMainGroup%)"/>

<!-- functional Groups-->
  <regex name="%anhydride%" value="(%anhydrideLocant%?%multiplier%?(%anhydride%|%openBracket%%anhydride%%closeBracket%))"/>
  <regex name="%acetal%" value="(%simpleMultiplier%?%chalcogenReplacement%{0,2}%acetalClass%)" />
  <regex name="%functionalClass%" value ="(%locantGroup%?%simpleMultiplierGroup%?%multiplyableFunctionalClass%%closeBracket%?|%acetal%|%anhydride%|%basicFunctionalClass%)"/>
  <regex name="%functionalGroup%" value ="(%multiplier%?(%monovalentFunctionalGroup%|%standaloneMonovalentFunctionalGroup%)|%divalentFunctionalGroup%)"/>
  <regex name="%functionalTerm%" value="(%hyphen%?(%functionalClass%|%functionalGroup%|%functionalModifier%)%endOfFunctionalGroup%)"/>

  <regex name="%chemical%" value="((%functionalModifier%%endOfFunctionalGroup%)?(%substituent%+|%substituent%*%mainGroup%)%functionalTerm%?|%functionalTerm%)"/>
<!--Note that the %functionalTerm%? in the term above indicates that a space has technically been omitted!-->
</regexes>